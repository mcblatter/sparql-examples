prefix ex: <https://sparql.nextprot.org/.well-known/sparql-examples>
prefix sh: <http://www.w3.org/ns/shacl#> 
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs:<http://www.w3.org/2000/01/rdf-schema#>
ex:NXQ_00146
 sh:prefixes _:sparql_examples_prefixes ;
  rdfs:comment '''Proteins having at least 2 proteotypic peptides of 7 or 8aa but no proteotypic peptide >= 9 aa''' ;
  sh:select '''select distinct ?entry where {
?entry np:isoform / np:peptideMapping ?pm.
?pm np:proteotypic true .
?pm np:peptideName ?pepid .
#?pm np:start ?pos1 ; np:end ?pos2 .
#filter((?pos2 - ?pos1 + 1) >= 7) # This is not absolutely required for current query since 7 is the minimum length for accepted proteotypic peptides
filter not exists {
 ?entry np:isoform / np:peptideMapping ?pm2.
 ?pm2 np:start ?p1 ; np:end ?p2 .
 ?pm2 np:proteotypic true .
 filter((?p2 - ?p1 + 1) >= 9)
 }
}
group by ?entry having(count (distinct ?pepid) >= 2)'''
.
